<!DOCTYPE html>
<html lang="nl">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Strandcabines Blankenberge</title>
   <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
   <style>
       .modal {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.5);
           z-index: 50;
       }
       .modal.active {
           display: flex;
       }
       .form-loading {
           opacity: 0.7;
           pointer-events: none;
       }
   </style>
</head>
<body class="bg-blue-50 min-h-screen">
   <div class="max-w-7xl mx-auto px-4 py-8">
       <header class="text-center mb-12">
           <h1 class="text-4xl font-bold text-blue-900 mb-4">Strandcabines Blankenberge</h1>
           <p class="text-blue-700">Verhuur seizoen 2025 - April tot September</p>
       </header>

       <div class="grid md:grid-cols-2 gap-8">
           <!-- Cabin 1 -->
           <div class="bg-white rounded-xl shadow-lg overflow-hidden">
               <div class="p-6">
                   <h2 class="text-2xl font-bold text-blue-900 mb-4">Strandcabine 1</h2>
                   <!-- Content here -->
               </div>
           </div>

           <!-- Cabin 2 -->
           <div class="bg-white rounded-xl shadow-lg overflow-hidden">
               <div class="p-6">
                   <h2 class="text-2xl font-bold text-blue-900 mb-4">Strandcabine 2</h2>
                   <!-- Content here -->
               </div>
           </div>
       </div>
   </div>

   <!-- Booking Modal -->
   <div id="bookingModal" class="modal">
       <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 my-8 md:m-auto">
           <h2 id="modalTitle" class="text-2xl font-bold mb-6">Reserveer Strandcabine</h2>
           
           <form id="bookingForm" onsubmit="handleBooking(event)" class="space-y-4">
               <div>
                   <label class="block mb-1 font-medium">Naam</label>
                   <input type="text" name="name" required class="w-full p-2 border rounded">
               </div>
               
               <div>
                   <label class="block mb-1 font-medium">Email</label>
                   <input type="email" name="email" required class="w-full p-2 border rounded">
               </div>

               <div>
                   <label class="block mb-1 font-medium">Telefoon</label>
                   <input type="tel" name="phone" required class="w-full p-2 border rounded">
               </div>

               <div>
                   <label class="block mb-1 font-medium">Periode</label>
                   <select name="period" required class="w-full p-2 border rounded" onchange="toggleIdUpload(this.value)">
                       <option value="day">Per dag (€50)</option>
                       <option value="twoWeeks">2 weken (€200)</option>
                       <option value="month">Per maand (vanaf €350)</option>
                       <option value="season">Heel seizoen (€1800)</option>
                   </select>
               </div>

               <div>
                   <label class="block mb-1 font-medium">Start datum</label>
                   <input 
                       type="date" 
                       name="startDate" 
                       required 
                       min="2025-04-01" 
                       max="2025-09-30" 
                       class="w-full p-2 border rounded"
                   >
               </div>

               <div id="idUploadField" style="display: none;">
                   <label class="block mb-1 font-medium">Identiteitskaart foto (verplicht voor dagverhuur)</label>
                   <input 
                       type="file" 
                       name="idCard" 
                       id="idCard"
                       accept="image/*"
                       class="w-full p-2 border rounded"
                   />
                   <p class="text-sm text-gray-500 mt-1">Upload een duidelijke foto van uw identiteitskaart</p>
               </div>

               <div class="flex gap-4 mt-8">
                   <button id="submitBtn" type="submit" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                       Reserveer
                   </button>
                   <button type="button" onclick="closeModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300">
                       Annuleer
                   </button>
               </div>
           </form>
       </div>
   </div>

   <!-- Confirmation Modal -->
   <div id="confirmationModal" class="modal">
       <div class="bg-white rounded-xl p-8 max-w-md w-full m-auto text-center">
           <h2 class="text-2xl font-bold mb-4">Bedankt voor uw reservering!</h2>
           <p class="text-gray-600">U ontvangt binnen enkele minuten een bevestigingsmail.</p>
           <button onclick="closeModal()" class="mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
               Sluiten
           </button>
       </div>
   </div>
   <script>
       let activeCabinId = null;

       function openBooking(cabinId) {
           console.log('Opening booking for cabin:', cabinId);
           activeCabinId = cabinId;
           const modal = document.getElementById('bookingModal');
           modal.classList.add('active');
           document.getElementById('modalTitle').textContent = `Reserveer Strandcabine ${cabinId}`;
       }

       function closeModal() {
           document.getElementById('bookingModal').classList.remove('active');
           document.getElementById('confirmationModal').classList.remove('active');
           const form = document.getElementById('bookingForm');
           if (form) form.reset();
           const idUploadField = document.getElementById('idUploadField');
           if (idUploadField) idUploadField.style.display = 'none';
           activeCabinId = null;
       }

       function toggleIdUpload(period) {
           const idUploadField = document.getElementById('idUploadField');
           idUploadField.style.display = period === 'day' ? 'block' : 'none';
       }

       async function handleBooking(event) {
           event.preventDefault();
           const form = event.target;
           const formData = new FormData(form);
           const period = formData.get('period');
           
           console.log('Form data:', {
               cabinId: activeCabinId,
               name: formData.get('name'),
               email: formData.get('email'),
               phone: formData.get('phone'),
               period: formData.get('period'),
               startDate: formData.get('startDate')
           });

           form.classList.add('form-loading');
           const submitBtn = document.getElementById('submitBtn');
           submitBtn.disabled = true;
           submitBtn.textContent = 'Bezig met reserveren...';

           try {
               let idDocumentFile = null;
               if (period === 'day') {
                   const idFile = document.getElementById('idCard').files[0];
                   if (!idFile) {
                       alert('Voor dagverhuur is een foto van uw identiteitskaart verplicht.');
                       return;
                   }

                   const formData = new FormData();
                   formData.append('idCard', idFile);

                   const response = await fetch('http://localhost:3000/upload', {
                       method: 'POST',
                       body: formData
                   });

                   if (!response.ok) {
                       throw new Error('Failed to upload file');
                   }

                   const result = await response.json();
                   console.log('ID document uploaded:', result);
                   idDocumentFile = result.file.Key;
               }

               // Store booking in database (you can use any database here)
               // For simplicity, we are just logging the booking details
               console.log({
                   cabinId: activeCabinId,
                   name: formData.get('name'),
                   email: formData.get('email'),
                   phone: formData.get('phone'),
                   period: formData.get('period'),
                   startDate: formData.get('startDate'),
                   idDocument: idDocumentFile
               });

               document.getElementById('bookingModal').classList.remove('active');
               document.getElementById('confirmationModal').classList.add('active');
               form.reset();

           } catch (error) {
               console.error('Error:', error);
               alert('Er ging iets mis. Probeer het opnieuw.');
           } finally {
               form.classList.remove('form-loading');
               submitBtn.disabled = false;
               submitBtn.textContent = 'Reserveer';
           }
       }

       // Close modals when clicking outside
       window.onclick = function(event) {
           if (event.target.classList.contains('modal')) {
               closeModal();
           }
       }

       // Initialize period selection
       document.querySelector('select[name="period"]').dispatchEvent(new Event('change'));
   </script>
</body>
</html>
