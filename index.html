<!DOCTYPE html>
<html lang="nl">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Strandcabines Blankenberge</title>
   <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
   <!-- Leaflet CSS voor OpenStreetMap -->
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
   <style>
       .modal {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.5);
           z-index: 50;
       }
       .modal.active {
           display: flex;
       }
       .form-loading {
           opacity: 0.7;
           pointer-events: none;
       }
       .map-container {
           height: 300px;
           width: 100%;
           border-radius: 8px;
           overflow: hidden;
       }
       .calendar-container {
           height: 500px;
           width: 100%;
           border: none;
           border-radius: 8px;
           overflow: hidden;
       }
       .date-picker-container {
           position: relative;
       }
       .date-disabled {
           background-color: #f2f2f2;
           color: #999;
           cursor: not-allowed;
       }
       /* Styling voor de kalenderweergave in het boekingsformulier */
       .custom-calendar {
           max-width: 100%;
           border-radius: 8px;
           overflow: hidden;
           margin-top: 10px;
           border: 1px solid #e2e8f0;
       }
       .custom-calendar-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           padding: 10px;
           background-color: #e6f2ff;
       }
       .custom-calendar-grid {
           display: grid;
           grid-template-columns: repeat(7, 1fr);
           background-color: white;
       }
       .custom-calendar-day {
           height: 40px;
           display: flex;
           justify-content: center;
           align-items: center;
           border: 1px solid #f0f0f0;
           cursor: pointer;
       }
       .custom-calendar-day-header {
           font-weight: bold;
           background-color: #f8fafc;
           height: 30px;
       }
       .custom-calendar-day.unavailable {
           background-color: #fee2e2;
           color: #ef4444;
           text-decoration: line-through;
           cursor: not-allowed;
       }
       .custom-calendar-day.selected {
           background-color: #3b82f6;
           color: white;
       }
       .custom-calendar-day.in-range {
           background-color: #dbeafe;
       }
       .custom-calendar-day.today {
           border: 2px solid #3b82f6;
       }
       .custom-calendar-day.different-month {
           color: #9ca3af;
       }
   </style>
</head>
<body class="bg-blue-50 min-h-screen">
   <div class="max-w-7xl mx-auto px-4 py-8">
       <header class="text-center mb-12">
           <h1 class="text-4xl font-bold text-blue-900 mb-4">Strandcabines Blankenberge</h1>
           <p class="text-blue-700">Verhuur seizoen 2025 - April tot September</p>
           <p class="text-red-600 mt-2">*Identiteitskaart vereist voor alle reserveringen</p>
       </header>

       <div class="grid md:grid-cols-2 gap-8">
           <!-- Cabin 1 -->
           <div class="bg-white rounded-xl shadow-lg overflow-hidden">
               <div class="p-6">
                   <h2 class="text-2xl font-bold text-blue-900 mb-4">Strandcabine 1</h2>
                   <div class="mb-6">
                       <h3 class="font-semibold text-blue-800 mb-2">Faciliteiten:</h3>
                       <ul class="list-disc list-inside space-y-1 text-gray-600">
                           <li>1 Tafel</li>
                           <li>2 Stoelen</li>
                           <li>2 Strandstoelen</li>
                           <li>1 Gordijn</li>
                           <li>Strandspeelgoed</li>
                           <li>1 Borsteltje</li>
                       </ul>
                   </div>
                   <div class="mb-6">
                       <h3 class="font-semibold text-blue-800 mb-2">Prijzen:</h3>
                       <div class="space-y-2 text-gray-600">
                           <p>Per week: €105</p>
                           <p>Per 2 weken: €205</p>
                           <div class="mt-2">
                               <p class="font-medium">Per maand:</p>
                               <ul class="ml-4 space-y-1">
                                   <li>April: €355</li>
                                   <li>Mei: €410</li>
                                   <li>Juni-Augustus: €510</li>
                                   <li>September: €355</li>
                               </ul>
                           </div>
                           <p class="mt-2 font-medium">Heel seizoen: €1825</p>
                       </div>
                   </div>
                   
                   <button onclick="openBooking(1)" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors">
                       Reserveer Nu
                   </button>
               </div>
           </div>

           <!-- Cabin 2 -->
           <div class="bg-white rounded-xl shadow-lg overflow-hidden">
               <div class="p-6">
                   <h2 class="text-2xl font-bold text-blue-900 mb-4">Strandcabine 2</h2>
                   <div class="mb-6">
                       <h3 class="font-semibold text-blue-800 mb-2">Faciliteiten:</h3>
                       <ul class="list-disc list-inside space-y-1 text-gray-600">
                           <li>1 Tafel</li>
                           <li>2 Stoelen</li>
                           <li>2 Strandstoelen</li>
                           <li>1 Gordijn</li>
                           <li>Strandspeelgoed</li>
                           <li>1 Borsteltje</li>
                       </ul>
                   </div>
                   <div class="mb-6">
                       <h3 class="font-semibold text-blue-800 mb-2">Prijzen:</h3>
                       <div class="space-y-2 text-gray-600">
                           <p>Per week: €105</p>
                           <p>Per 2 weken: €205</p>
                           <div class="mt-2">
                               <p class="font-medium">Per maand:</p>
                               <ul class="ml-4 space-y-1">
                                   <li>April: €355</li>
                                   <li>Mei: €410</li>
                                   <li>Juni-Augustus: €510</li>
                                   <li>September: €355</li>
                               </ul>
                           </div>
                           <p class="mt-2 font-medium">Heel seizoen: €1825</p>
                       </div>
                   </div>
                   
                   <button onclick="openBooking(2)" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors">
                       Reserveer Nu
                   </button>
               </div>
           </div>
       </div>
       <!-- Locatie Sectie -->
       <div class="mt-12 bg-white rounded-xl shadow-lg p-6">
           <h2 class="text-2xl font-bold text-blue-900 mb-4">Locatie</h2>
           <div class="text-gray-600 mb-4">
               <p>Onze strandcabines bevinden zich op een ideale locatie aan het strand van Blankenberge.</p>
               <p class="mt-2">Coördinaten: 51°19'04.1"N 3°07'58.5"E</p>
           </div>
           <div class="map-container" id="map"></div>
           <div class="mt-4">
               <a href="https://www.openstreetmap.org/?mlat=51.317806&mlon=3.132917&zoom=16" target="_blank" class="text-blue-600 hover:underline flex items-center">
                   <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                   </svg>
                   Bekijk in OpenStreetMap
               </a>
           </div>
       </div>

       <!-- Betalingsinformatie -->
       <div class="mt-8 bg-white rounded-xl shadow-lg p-6">
           <h2 class="text-2xl font-bold text-blue-900 mb-4">Betalingsinformatie</h2>
           <div class="text-gray-600">
               <p class="mb-4">Het reserverings- en betalingsproces verloopt als volgt:</p>
               <ol class="list-decimal list-inside space-y-2 mb-6">
                   <li>U vult het reserveringsformulier in en uploadt uw ID</li>
                   <li>U wordt doorverwezen naar onze veilige betaalomgeving</li>
                   <li>Na betaling is uw reservering direct bevestigd</li>
                   <li>U ontvangt een bevestigingsmail met alle details</li>
               </ol>
               
               <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                   <h3 class="font-semibold text-yellow-800 mb-2">Belangrijk:</h3>
                   <ul class="list-disc list-inside space-y-1">
                       <li>Alle betalingen verlopen veilig via Stripe</li>
                       <li>U kunt betalen met creditcard, Bancontact of iDEAL</li>
                       <li>Annuleringsvoorwaarden:
                           <ul class="ml-6 mt-1 space-y-1">
                               <li>Bij annulering meer dan 30 dagen voor aankomst: volledige terugbetaling</li>
                               <li>Bij annulering minder dan 30 dagen voor aankomst: 50% van het betaalde bedrag wordt ingehouden</li>
                           </ul>
                       </li>
                   </ul>
               </div>
           </div>
       </div>

       <!-- Beveiliging en Privacy -->
       <div class="mt-8 bg-white rounded-xl shadow-lg p-6">
           <h2 class="text-2xl font-bold text-blue-900 mb-4">Beveiliging & Privacy</h2>
           <div class="text-gray-600">
               <p class="mb-2">Voor uw en onze veiligheid vragen wij om een kopie van uw identiteitskaart bij elke reservering.</p>
               <p class="mb-2">Uw gegevens worden vertrouwelijk behandeld in overeenstemming met de AVG/GDPR regelgeving:</p>
               <ul class="list-disc list-inside space-y-1 mb-4">
                   <li>Uw ID wordt alleen gebruikt voor identiteitsverificatie</li>
                   <li><strong class="text-blue-800">Uw ID-kopie wordt uitsluitend bewaard gedurende uw huurperiode plus 2 dagen, waarna deze permanent wordt verwijderd</strong></li>
                   <li>Uw ID-kopie wordt veilig opgeslagen in een beveiligde Google Drive map met tweefactorauthenticatie</li>
                   <li>Betalingsgegevens worden verwerkt door Stripe, een gecertificeerde en veilige betalingsverwerker</li>
                   <li>Wij hebben geen toegang tot uw volledige kaartgegevens</li>
                   <li>Uw gegevens worden niet gedeeld met derden</li>
               </ul>
               <p class="text-sm italic">Voor vragen over hoe wij omgaan met uw persoonsgegevens, kunt u altijd contact met ons opnemen.</p>
           </div>
       </div>

       <!-- Contact Informatie -->
       <div class="mt-8 bg-white rounded-xl shadow-lg p-6">
           <h2 class="text-2xl font-bold text-blue-900 mb-4">Contact Informatie</h2>
           <div class="flex flex-col md:flex-row md:space-x-8">
               <div class="flex-1 mb-4 md:mb-0">
                   <h3 class="font-semibold text-blue-800 mb-2">Contacteer ons</h3>
                   <p class="text-gray-600">Voor meer informatie of vragen, neem gerust contact met ons op:</p>
                   <ul class="mt-2 space-y-1 text-gray-600">
                       <li>Telefoon: <a href="tel:+32474662781" class="text-blue-600 hover:underline">+32 474 662781</a></li>
                       <li>E-mail: <a href="mailto:gregoirefauvarque@hotmail.be" class="text-blue-600 hover:underline">gregoirefauvarque@hotmail.be</a></li>
                   </ul>
               </div>
               <div class="flex-1">
                   <h3 class="font-semibold text-blue-800 mb-2">Routebeschrijving</h3>
                   <p class="text-gray-600">De strandcabines zijn gemakkelijk bereikbaar vanaf het centrum van Blankenberge. Volg de kustlijn en u vindt onze cabines aan het aangegeven punt op de kaart.</p>
               </div>
           </div>
       </div>
   </div>
   <!-- Booking Modal -->
   <div id="bookingModal" class="modal">
       <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 my-8 md:m-auto overflow-auto max-h-screen">
           <h2 id="modalTitle" class="text-2xl font-bold mb-6">Reserveer Strandcabine</h2>
           
           <form id="bookingForm" action="https://formspree.io/f/xnnpnjjr" method="POST" class="space-y-4">
               <input type="hidden" id="cabinId" name="cabinId">
               <div>
                   <label class="block mb-1 font-medium">Naam</label>
                   <input type="text" name="name" required class="w-full p-2 border rounded">
               </div>
               
               <div>
                   <label class="block mb-1 font-medium">Email</label>
                   <input type="email" name="email" required class="w-full p-2 border rounded">
               </div>

               <div>
                   <label class="block mb-1 font-medium">Telefoon</label>
                   <input type="tel" name="phone" required class="w-full p-2 border rounded">
               </div>

               <div>
                   <label class="block mb-1 font-medium">Periode</label>
                   <select name="period" required class="w-full p-2 border rounded" id="periodSelect" onchange="updateCalendarView()">
                       <option value="week">Per week (€105)</option>
                       <option value="twoWeeks">2 weken (€205)</option>
                       <option value="monthApril">April (€355)</option>
                       <option value="monthMay">Mei (€410)</option>
                       <option value="monthSummer">Juni-Augustus (€510)</option>
                       <option value="monthSeptember">September (€355)</option>
                       <option value="season">Heel seizoen (€1825)</option>
                   </select>
               </div>

               <!-- Custom Calendar Selection -->
               <div>
                   <label class="block mb-1 font-medium">Selecteer datum</label>
                   <div class="date-picker-container">
                       <input 
                           type="text" 
                           id="selectedDateDisplay" 
                           readonly
                           class="w-full p-2 border rounded cursor-pointer"
                           placeholder="Klik om datum te selecteren"
                           onclick="toggleCalendarView()"
                       >
                       <input type="hidden" id="startDateInput" name="startDate" required>
                       <input type="hidden" id="endDateInput" name="endDate">
                       
                       <!-- Inline Calendar View (initially hidden) -->
                       <div id="calendarView" class="custom-calendar hidden">
                           <div class="custom-calendar-header">
                               <button type="button" class="px-2 py-1 bg-blue-100 rounded" onclick="changeMonth(-1)">&lt;</button>
                               <span id="currentMonthYear" class="font-medium">Mei 2025</span>
                               <button type="button" class="px-2 py-1 bg-blue-100 rounded" onclick="changeMonth(1)">&gt;</button>
                           </div>
                           <div class="custom-calendar-grid" id="calendarGrid">
                               <!-- Dagen van de week koppen -->
                               <div class="custom-calendar-day custom-calendar-day-header">Ma</div>
                               <div class="custom-calendar-day custom-calendar-day-header">Di</div>
                               <div class="custom-calendar-day custom-calendar-day-header">Wo</div>
                               <div class="custom-calendar-day custom-calendar-day-header">Do</div>
                               <div class="custom-calendar-day custom-calendar-day-header">Vr</div>
                               <div class="custom-calendar-day custom-calendar-day-header">Za</div>
                               <div class="custom-calendar-day custom-calendar-day-header">Zo</div>
                               
                               <!-- Kalender dagen worden hier dynamisch ingevuld -->
                           </div>
                       </div>
                   </div>
                   <p id="dateAvailabilityMessage" class="text-sm text-red-600 hidden mt-1">Deze datum is niet beschikbaar.</p>
               </div>

               <div>
                   <label class="block mb-1 font-medium">Bericht (optioneel)</label>
                   <textarea name="message" class="w-full p-2 border rounded" rows="3"></textarea>
               </div>
               
               <div class="p-4 bg-blue-50 rounded border mt-2">
                   <p class="font-medium text-blue-800">Volgende stappen:</p>
                   <p class="text-gray-600">Na het indienen van dit formulier wordt u doorverwezen naar:</p>
                   <ol class="list-decimal list-inside text-sm text-gray-600 mt-2">
                       <li>Een beveiligde pagina om uw ID te uploaden</li>
                       <li>Een beveiligde betaalpagina om direct de reservering te voltooien</li>
                   </ol>
               </div>
               
               <div class="mt-4">
                   <label class="flex items-start">
                       <input type="checkbox" required name="terms_consent" class="mt-1 mr-2">
                       <span class="text-sm text-gray-600">Ik ga akkoord met de huurvoorwaarden en privacy beleid.*</span>
                   </label>
               </div>

               <div class="flex gap-4 mt-8">
                   <button id="submitBtn" type="submit" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                       Reserveer
                   </button>
                   <button type="button" onclick="closeModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300">
                       Annuleer
                   </button>
               </div>
           </form>
       </div>
   </div>

   <!-- ID Upload Modal -->
   <div id="idUploadModal" class="modal">
       <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 my-8 md:m-auto overflow-auto max-h-screen">
           <h2 class="text-2xl font-bold mb-6">Upload uw identiteitskaart</h2>
           
           <div class="text-gray-600 mb-6">
               <p>Uw reservering is bijna voltooid! Om het proces af te ronden, dient u uw identiteitskaart te uploaden via ons beveiligde formulier.</p>
               <p class="mt-2 text-sm font-medium text-blue-800">Deze kopie wordt uitsluitend bewaard gedurende uw huurperiode plus 2 dagen, waarna deze permanent wordt verwijderd.</p>
           </div>
           
           <a href="https://docs.google.com/forms/d/e/1FAIpQLSdY_-rAZzOolLgfscXgCmKEuNLDrHlj2bmuWurnw92NJk6MNQ/viewform?usp=header" target="_blank" class="block w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center">
               Upload uw ID via Google Forms
           </a>
           
           <p class="text-sm text-gray-500 mt-4">Na het uploaden van uw ID via Google Forms, klik op de onderstaande knop om naar de betaalpagina te gaan.</p>
           
           <div class="flex gap-4 mt-6">
               <button type="button" onclick="showPaymentOptions()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">
                   ID Geüpload, Ga naar Betaling
               </button>
               <button type="button" onclick="closeModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300">
                   Annuleer
               </button>
           </div>
       </div>
   </div>
   
   <!-- Payment Modal -->
   <div id="paymentModal" class="modal">
       <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 my-8 md:m-auto overflow-auto max-h-screen">
           <h2 class="text-2xl font-bold mb-6">Betaling</h2>
           
           <div class="text-gray-600 mb-6">
               <p>Selecteer de betaallink die overeenkomt met uw reservering:</p>
           </div>
           
           <div class="space-y-4">
               <div id="payment-week" class="hidden">
                   <a href="https://buy.stripe.com/00g3cv3qVbTv2UE289" target="_blank" class="block w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center">
                       Betaal voor Week verhuur (€105)
                   </a>
               </div>
               
               <div id="payment-twoWeeks" class="hidden">
                   <a href="https://buy.stripe.com/6oE28r0eJ4r3cvefZ0" target="_blank" class="block w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center">
                       Betaal voor 2 Weken (€205)
                   </a>
               </div>
               
               <div id="payment-monthApril" class="hidden">
                   <a href="https://buy.stripe.com/5kA8wPe5z8Hj7aU5kn" target="_blank" class="block w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center">
                       Betaal voor April (€355)
                   </a>
               </div>
               
               <div id="payment-monthMay" class="hidden">
                   <a href="https://buy.stripe.com/28o5kDaTng9L7aUfZ2" target="_blank" class="block w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center">
                       Betaal voor Mei (€410)
                   </a>
               </div>
               
               <div id="payment-monthSummer" class="hidden">
                   <a href="https://buy.stripe.com/5kA9ATd1v9LneDm28d" target="_blank" class="block w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center">
                       Betaal voor Juni-Augustus (€510)
                   </a>
               </div>
               
               <div id="payment-monthSeptember" class="hidden">
                   <a href="https://buy.stripe.com/3cs4gz3qV6zbdzi5kr" target="_blank" class="block w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center">
                       Betaal voor September (€355)
                   </a>
               </div>
               
               <div id="payment-season" class="hidden">
                   <a href="https://buy.stripe.com/eVadR9aTn7DfeDm4gm" target="_blank" class="block w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center">
                       Betaal voor Heel Seizoen (€1825)
                   </a>
               </div>
           </div>
           
           <p class="text-sm text-gray-500 mt-4">Na betaling wordt u automatisch teruggestuurd naar deze website voor bevestiging.</p>
           
           <div class="flex gap-4 mt-6">
               <button type="button" onclick="showConfirmation()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">
                   Betaling Voltooid
               </button>
               <button type="button" onclick="closeModal()" class="flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300">
                   Annuleer
               </button>
           </div>
       </div>
   </div>

   <!-- Confirmation Modal -->
   <div id="confirmationModal" class="modal">
       <div class="bg-white rounded-xl p-8 max-w-md w-full m-auto text-center">
           <h2 class="text-2xl font-bold mb-4">Bedankt voor uw reservering!</h2>
           <p class="text-gray-600 mb-4">Uw reservering en betaling zijn succesvol verwerkt. U ontvangt binnen enkele minuten een bevestigingsmail met alle details.</p>
           <p class="text-sm text-blue-800 mt-4">Uw ID-kopie wordt veilig bewaard en automatisch verwijderd na uw huurperiode + 2 dagen.</p>
           <button onclick="closeAllModals()" class="mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
               Sluiten
           </button>
       </div>
   </div>

   <footer class="bg-blue-900 text-white py-6 mt-12">
       <div class="max-w-7xl mx-auto px-4 text-center">
           <p>&copy; 2025 Strandcabines Blankenberge. Alle rechten voorbehouden.</p>
       </div>
   </footer>
   <!-- Leaflet JavaScript voor OpenStreetMap -->
   <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
   
   <script>
       let activeCabinId = null;
       let formData = {};
       let currentViewDate = new Date(2025, 3, 1); // 1 april 2025
       let selectedStartDate = null;
       let selectedEndDate = null;

       // Kalendergedrag
       let calendarVisible = false;
       
       // Functie om te controleren of een datum bezet is in de Outlook-kalender
       // In werkelijkheid zou dit een API-aanroep zijn naar je backend die de Outlook API raadpleegt
       function isDateBusyInOutlook(cabinId, date) {
           // Simuleer bezette data uit de Outlook-kalender
           // Bij een echte implementatie zou dit gegevens ophalen uit je Outlook-kalender API
           const busyDates = {
               1: [
                   // Mei data is verwijderd om deze volledig beschikbaar te maken
                   "2025-06-15", "2025-06-16", "2025-06-17", "2025-06-18",
                   "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04",
                   "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-23"
               ],
               2: [
                   "2025-04-10", "2025-04-11", "2025-04-12", "2025-04-13",
                   // Mei data is verwijderd om deze volledig beschikbaar te maken
                   "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03",
                   "2025-08-15", "2025-08-16", "2025-08-17", "2025-08-18"
               ]
           };
           
           // Converteer datum naar de juiste string-indeling (YYYY-MM-DD)
           const dateStr = date.toISOString().split('T')[0];
           
           // Controleer of de datum in de lijst met bezette datums staat
           return busyDates[cabinId].includes(dateStr);
       }
       
       // Functie om de startdatum en einddatum te berekenen op basis van de geselecteerde periode
       function calculateDateRange(startDate, periodType) {
           const start = new Date(startDate);
           let end;
           
           switch (periodType) {
               case 'week':
                   end = new Date(start);
                   end.setDate(end.getDate() + 6); // 7 dagen (inclusief startdag)
                   break;
               case 'twoWeeks':
                   end = new Date(start);
                   end.setDate(end.getDate() + 13); // 14 dagen (inclusief startdag)
                   break;
               case 'monthApril':
                   start = new Date(2025, 3, 1); // 1 april 2025
                   end = new Date(2025, 3, 30); // 30 april 2025
                   break;
               case 'monthMay':
                   start = new Date(2025, 4, 1); // 1 mei 2025
                   end = new Date(2025, 4, 31); // 31 mei 2025
                   break;
               case 'monthSummer':
                   // De gebruiker selecteert juni, juli of augustus
                   const month = start.getMonth();
                   start = new Date(2025, month, 1); // Eerste dag van de geselecteerde maand
                   
                   // Laatste dag van de geselecteerde maand
                   if (month === 5) { // Juni
                       end = new Date(2025, 5, 30);
                   } else if (month === 6) { // Juli
                       end = new Date(2025, 6, 31);
                   } else { // Augustus
                       end = new Date(2025, 7, 31);
                   }
                   break;
               case 'monthSeptember':
                   start = new Date(2025, 8, 1); // 1 september 2025
                   end = new Date(2025, 8, 30); // 30 september 2025
                   break;
               case 'season':
                   start = new Date(2025, 3, 1); // 1 april 2025
                   end = new Date(2025, 8, 30); // 30 september 2025
                   break;
               default:
                   end = new Date(start);
                   break;
           }
           
           return { start, end };
       }
       
       // Functie om te controleren of een datumbereik volledig beschikbaar is
       function isDateRangeAvailable(cabinId, startDate, endDate) {
           // Voor elke dag in het bereik, controleren of deze bezet is
           for (let date = new Date(startDate); date <= endDate; date.setDate(date.getDate() + 1)) {
               if (isDateBusyInOutlook(cabinId, date)) {
                   return false; // Als één dag bezet is, is het bereik niet beschikbaar
               }
           }
           
           return true; // Alle dagen zijn beschikbaar
       }
       
       // Datum-helper functies
       function formatDate(date) {
           return date.toLocaleDateString('nl-BE', { 
               day: '2-digit', 
               month: '2-digit', 
               year: 'numeric' 
           });
       }
       
       function formatDateYYYYMMDD(date) {
           const year = date.getFullYear();
           const month = String(date.getMonth() + 1).padStart(2, '0');
           const day = String(date.getDate()).padStart(2, '0');
           return `${year}-${month}-${day}`;
       }

       function getDaysInMonth(year, month) {
           return new Date(year, month + 1, 0).getDate();
       }
       
       function getFirstDayOfMonth(year, month) {
           return new Date(year, month, 1).getDay();
       }
       
       // Rendering van de kalender
       function renderCalendar() {
           const year = currentViewDate.getFullYear();
           const month = currentViewDate.getMonth();
           
           // Update de maand/jaar weergave
           document.getElementById('currentMonthYear').textContent = 
               currentViewDate.toLocaleDateString('nl-BE', { month: 'long', year: 'numeric' });
           
           // Dagen in de maand
           const daysInMonth = getDaysInMonth(year, month);
           
           // Eerste dag van de maand (0 = zondag, 1 = maandag, etc.)
           let firstDay = getFirstDayOfMonth(year, month);
           // Converteer van zondag=0 naar maandag=0 formaat (voor onze kalender die met maandag begint)
           firstDay = firstDay === 0 ? 6 : firstDay - 1;
           
           // Verkrijg de container voor de kalenderdagen
           const calendarGrid = document.getElementById('calendarGrid');
           
           // Wis bestaande dagen na de header rij
           while (calendarGrid.children.length > 7) {
               calendarGrid.removeChild(calendarGrid.lastChild);
           }
           
           // Voeg lege cellen toe voor dagen vóór de eerste dag van de maand
           for (let i = 0; i < firstDay; i++) {
               const prevMonthDay = document.createElement('div');
               prevMonthDay.className = 'custom-calendar-day different-month';
               
               // Bereken de datum van de vorige maand
               const prevMonthDate = new Date(year, month, 0 - (firstDay - i - 1));
               prevMonthDay.textContent = prevMonthDate.getDate();
               prevMonthDay.dataset.date = formatDateYYYYMMDD(prevMonthDate);
               
               // Controleer of deze datum bezet is
               if (isDateBusyInOutlook(activeCabinId, prevMonthDate)) {
                   prevMonthDay.classList.add('unavailable');
               } else {
                   prevMonthDay.addEventListener('click', () => selectDate(prevMonthDate));
               }
               
               calendarGrid.appendChild(prevMonthDay);
           }
           
           // Voeg dagen van de huidige maand toe
           const today = new Date();
           for (let day = 1; day <= daysInMonth; day++) {
               const date = new Date(year, month, day);
               const dayElement = document.createElement('div');
               dayElement.className = 'custom-calendar-day';
               dayElement.textContent = day;
               dayElement.dataset.date = formatDateYYYYMMDD(date);
               
               // Markeer vandaag
               if (date.getDate() === today.getDate() && 
                   date.getMonth() === today.getMonth() && 
                   date.getFullYear() === today.getFullYear()) {
                   dayElement.classList.add('today');
               }
               
               // Controleer of deze datum geselecteerd is
               if (selectedStartDate && selectedEndDate) {
                   if (date >= selectedStartDate && date <= selectedEndDate) {
                       if (date.getTime() === selectedStartDate.getTime() || 
                           date.getTime() === selectedEndDate.getTime()) {
                           dayElement.classList.add('selected');
                       } else {
                           dayElement.classList.add('in-range');
                       }
                   }
               }
               
               // Controleer of deze datum bezet is
               if (isDateBusyInOutlook(activeCabinId, date)) {
                   dayElement.classList.add('unavailable');
               } else {
                   dayElement.addEventListener('click', () => selectDate(date));
               }
               
               calendarGrid.appendChild(dayElement);
           }
           
           // Voeg lege cellen toe voor dagen na de laatste dag van de maand
           const totalCells = Math.ceil((firstDay + daysInMonth) / 7) * 7;
           for (let i = firstDay + daysInMonth; i < totalCells; i++) {
               const nextMonthDay = document.createElement('div');
               nextMonthDay.className = 'custom-calendar-day different-month';
               
               // Bereken de datum van de volgende maand
               const nextMonthDate = new Date(year, month + 1, i - (firstDay + daysInMonth) + 1);
               nextMonthDay.textContent = nextMonthDate.getDate();
               nextMonthDay.dataset.date = formatDateYYYYMMDD(nextMonthDate);
               
               // Controleer of deze datum bezet is
               if (isDateBusyInOutlook(activeCabinId, nextMonthDate)) {
                   nextMonthDay.classList.add('unavailable');
               } else {
                   nextMonthDay.addEventListener('click', () => selectDate(nextMonthDate));
               }
               
               calendarGrid.appendChild(nextMonthDay);
           }
       }
       
       // Functie om van maand te veranderen
       function changeMonth(direction) {
           currentViewDate.setMonth(currentViewDate.getMonth() + direction);
           renderCalendar();
       }
       
       // Functie om de kalenderweergave te tonen/verbergen
       function toggleCalendarView() {
           const calendarView = document.getElementById('calendarView');
           calendarVisible = !calendarVisible;
           
           if (calendarVisible) {
               calendarView.classList.remove('hidden');
               renderCalendar();
           } else {
               calendarView.classList.add('hidden');
           }
       }
       
       // Datum selectie functie
       function selectDate(date) {
           // Controleer eerst of de datum niet bezet is
           if (isDateBusyInOutlook(activeCabinId, date)) {
               return; // Sta selectie van bezette dagen niet toe
           }
           
           // Bepaal de selectiemodus op basis van de geselecteerde periode
           const periodSelect = document.getElementById('periodSelect');
           const period = periodSelect.value;
           
           // Bereken het datumbereik op basis van de geselecteerde datum en periode
           const dateRange = calculateDateRange(date, period);
           
           // Controleer of het volledige bereik beschikbaar is
           if (!isDateRangeAvailable(activeCabinId, dateRange.start, dateRange.end)) {
               // Toon foutmelding
               const errorMessage = document.getElementById('dateAvailabilityMessage');
               errorMessage.textContent = `Eén of meer dagen in de gekozen periode zijn niet beschikbaar.`;
               errorMessage.classList.remove('hidden');
               return;
           }
           
           // Stel de geselecteerde start- en einddatum in
           selectedStartDate = dateRange.start;
           selectedEndDate = dateRange.end;
           
           // Update de zichtbare datum weergave
           document.getElementById('selectedDateDisplay').value = 
               `${formatDate(selectedStartDate)} - ${formatDate(selectedEndDate)}`;
           
           // Update de formulierinvoervelden
           document.getElementById('startDateInput').value = formatDateYYYYMMDD(selectedStartDate);
           document.getElementById('endDateInput').value = formatDateYYYYMMDD(selectedEndDate);
           
           // Verberg eventuele foutmelding
           document.getElementById('dateAvailabilityMessage').classList.add('hidden');
           
           // Herlaad de kalender om de selectie weer te geven
           renderCalendar();
       }
       
       // Functie om de kalenderweergave bij te werken wanneer de periode verandert
       function updateCalendarView() {
           const periodSelect = document.getElementById('periodSelect');
           const period = periodSelect.value;
           
           // Reset geselecteerde datums
           selectedStartDate = null;
           selectedEndDate = null;
           
           // Wis de weergave
           document.getElementById('selectedDateDisplay').value = '';
           document.getElementById('startDateInput').value = '';
           document.getElementById('endDateInput').value = '';
           
           // Reset kalenderweergave
           if (calendarVisible) {
               renderCalendar();
           }
           
           // Toon periodepecifieke hint
           let hint = '';
           switch (period) {
               case 'monthApril':
                   hint = '1 april - 30 april 2025';
                   // Controleer direct of april beschikbaar is
                   if (!isDateRangeAvailable(activeCabinId, new Date(2025, 3, 1), new Date(2025, 3, 30))) {
                       document.getElementById('dateAvailabilityMessage').textContent = 'April is niet volledig beschikbaar.';
                       document.getElementById('dateAvailabilityMessage').classList.remove('hidden');
                   } else {
                       document.getElementById('dateAvailabilityMessage').classList.add('hidden');
                   }
                   break;
               case 'monthMay':
                   hint = '1 mei - 31 mei 2025';
                   // Mei is nu volledig beschikbaar, dus deze check zal altijd slagen
                   document.getElementById('dateAvailabilityMessage').classList.add('hidden');
                   break;
               case 'monthSummer':
                   hint = 'Selecteer een startdatum in juni, juli of augustus';
                   document.getElementById('dateAvailabilityMessage').classList.add('hidden');
                   break;
               case 'monthSeptember':
                   hint = '1 september - 30 september 2025';
                   // Controleer direct of september beschikbaar is
                   if (!isDateRangeAvailable(activeCabinId, new Date(2025, 8, 1), new Date(2025, 8, 30))) {
                       document.getElementById('dateAvailabilityMessage').textContent = 'September is niet volledig beschikbaar.';
                       document.getElementById('dateAvailabilityMessage').classList.remove('hidden');
                   } else {
                       document.getElementById('dateAvailabilityMessage').classList.add('hidden');
                   }
                   break;
               case 'season':
                   hint = '1 april - 30 september 2025';
                   // Controleer direct of het hele seizoen beschikbaar is
                   if (!isDateRangeAvailable(activeCabinId, new Date(2025, 3, 1), new Date(2025, 8, 30))) {
                       document.getElementById('dateAvailabilityMessage').textContent = 'Het hele seizoen is niet volledig beschikbaar.';
                       document.getElementById('dateAvailabilityMessage').classList.remove('hidden');
                   } else {
                       document.getElementById('dateAvailabilityMessage').classList.add('hidden');
                   }
                   break;
               case 'week':
                   hint = 'Selecteer een startdatum voor de week';
                   document.getElementById('dateAvailabilityMessage').classList.add('hidden');
                   break;
               case 'twoWeeks':
                   hint = 'Selecteer een startdatum voor de 2 weken';
                   document.getElementById('dateAvailabilityMessage').classList.add('hidden');
                   break;
           }
           
           document.getElementById('selectedDateDisplay').placeholder = hint;
       }

       // Initialiseer de kaart wanneer het document geladen is
       document.addEventListener('DOMContentLoaded', function() {
           // Coördinaten: 51°19'04.1"N 3°07'58.5"E = 51.317806, 3.132917
           const lat = 51.317806;
           const lng = 3.132917;
           
           // Maak een nieuwe kaart in het "map" element
           const map = L.map('map').setView([lat, lng], 16);
           
           // Voeg de OpenStreetMap tile layer toe
           L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
               attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
           }).addTo(map);
           
           // Voeg een marker toe op de locatie
           const marker = L.marker([lat, lng]).addTo(map);
           
           // Voeg een popup toe
           marker.bindPopup("<strong>Strandcabines Blankenberge</strong><br>Hier vindt u onze strandcabines!").openPopup();
           
           // Sluit eventuele actieve modals bij klikken buiten kalenderweergave
           document.addEventListener('click', function(event) {
               const calendarView = document.getElementById('calendarView');
               const dateDisplay = document.getElementById('selectedDateDisplay');
               
               if (calendarVisible && 
                   !calendarView.contains(event.target) && 
                   event.target !== dateDisplay) {
                   calendarVisible = false;
                   calendarView.classList.add('hidden');
               }
           });
       });
       
       function openBooking(cabinId) {
           activeCabinId = cabinId;
           document.getElementById('cabinId').value = cabinId;
           const modal = document.getElementById('bookingModal');
           modal.classList.add('active');
           document.getElementById('modalTitle').textContent = `Reserveer Strandcabine ${cabinId}`;
           
           // Reset het formulier
           document.getElementById('bookingForm').reset();
           
           // Verberg foutberichten
           document.getElementById('dateAvailabilityMessage').classList.add('hidden');
           
           // Update kalenderweergave op basis van de geselecteerde periode
           updateCalendarView();
       }

       function closeModal() {
           document.getElementById('bookingModal').classList.remove('active');
           document.getElementById('idUploadModal').classList.remove('active');
           document.getElementById('paymentModal').classList.remove('active');
           document.getElementById('confirmationModal').classList.remove('active');
           
           const form = document.getElementById('bookingForm');
           if (form) form.reset();
           
           // Reset kalenderweergave
           calendarVisible = false;
           const calendarView = document.getElementById('calendarView');
           if (calendarView) {
               calendarView.classList.add('hidden');
           }
       }
       
       function closeAllModals() {
           closeModal();
           formData = {};
           selectedStartDate = null;
           selectedEndDate = null;
       }
       
       function showIdUploadModal() {
           document.getElementById('bookingModal').classList.remove('active');
           document.getElementById('idUploadModal').classList.add('active');
       }
       
       function showPaymentOptions() {
           document.getElementById('idUploadModal').classList.remove('active');
           document.getElementById('paymentModal').classList.add('active');
           
           // Verberg eerst alle betalingsopties
           document.querySelectorAll('#paymentModal [id^="payment-"]').forEach(el => {
               el.classList.add('hidden');
           });
           
           // Toon de relevante betalingsoptie op basis van de periode
           if (formData.period) {
               const paymentDiv = document.getElementById(`payment-${formData.period}`);
               if (paymentDiv) {
                   paymentDiv.classList.remove('hidden');
               }
           }
       }
       
       function showConfirmation() {
           document.getElementById('paymentModal').classList.remove('active');
           document.getElementById('confirmationModal').classList.add('active');
       }

       // Formulierverwerking met Formspree
       document.getElementById('bookingForm').addEventListener('submit', async function(event) {
           // Voorkom standaard formulierinzending om het zelf af te handelen
           event.preventDefault();
           
           // Controleer of er een datum is geselecteerd
           if (!document.getElementById('startDateInput').value) {
               document.getElementById('dateAvailabilityMessage').textContent = 'Selecteer a.u.b. een datum.';
               document.getElementById('dateAvailabilityMessage').classList.remove('hidden');
               return;
           }
           
           // Toon laadstatus
           const form = this;
           form.classList.add('form-loading');
           
           const submitBtn = document.getElementById('submitBtn');
           submitBtn.disabled = true;
           submitBtn.textContent = 'Bezig met verzenden...';
           
           try {
               // Sla formuliergegevens op
               const formDataObj = new FormData(form);
               formData = {};
               for (let [key, value] of formDataObj.entries()) {
                   formData[key] = value;
               }
               
               // Verstuur formulier naar Formspree
               const response = await fetch(form.action, {
                   method: form.method,
                   body: formDataObj,
                   headers: {
                       'Accept': 'application/json'
                   }
               });
               
               if (response.ok) {
                   // Toon ID-uploadmodal na succesvolle formulierinzending
                   showIdUploadModal();
               } else {
                   // Foutafhandeling
                   alert('Er ging iets mis. Probeer het later opnieuw of neem contact met ons op.');
               }
           } catch (error) {
               console.error('Error:', error);
               alert('Er ging iets mis. Probeer het later opnieuw of neem contact met ons op.');
           } finally {
               form.classList.remove('form-loading');
               submitBtn.disabled = false;
               submitBtn.textContent = 'Reserveer';
           }
       });

       // Sluit modals wanneer er buiten wordt geklikt
       window.onclick = function(event) {
           if (event.target.classList.contains('modal')) {
               closeModal();
           }
       }
   </script>
</body>
</html>
